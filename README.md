# 3 курс
# Киценко Марина Алексеевна
# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура проекта

Проект организован по принципу MVP (Model-View-Presenter).
Все функциональные элементы разделены на следующие слои:

Models:
- Отвечают за логику работы с данными приложения.
- Обрабатывают данные, пришедшие из API, и предоставляют их для других слоёв.

Views:
- Обеспечивают отображение данных и интерфейсов. Содержат компоненты для работы с DOM.

Presenter:
- Обрабатывает логику взаимодействия между слоями Models и Views, используя EventEmitter для связи.
- Реализован в файле index.ts

## Описание классов и компонентов

Models
- AppState: Хранит состояние приложения, включая каталог, корзину и данные заказа.
- Product: Представляет данные о товаре, включая информацию о категории, цене, изображении и принадлежности к корзине.

Views
- Page: Отвечает за отображение каталога товаров на главной странице, включая элементы интерфейса корзины.
- Card: Отображает карточку товара. Реализует отображение названия, описания, изображения, цены и кнопки добавления в корзину.
- Modal: Базовый компонент для отображения модальных окон.
- Basket: Реализует отображение содержимого корзины, её стоимости и кнопки оформления заказа.
- Form: Обобщённый компонент для работы с HTML-формами (например, формой заказа).
- Order: Расширяет функциональность Form, добавляя методы для отображения и обработки данных заказа.
- Success: Отображает сообщение об успешном заказе, включая итоговую стоимость.

ViewModels
- ProductViewModel: Управляет данными для карточек товаров, передаёт их во Views.
- CartViewModel: Управляет данными корзины, добавлением и удалением товаров.
- OrderViewModel: Обрабатывает данные для оформления заказа, отправляет запрос на сервер при подтверждении оплаты.

## Описание типов данных

ApiConfig — Конфигурация API. Определяет базовый URL и методы для взаимодействия с сервером.
- baseUrl (string): Базовый URL для API.
- get<T>(endpoint: string): Promise<T>: Метод для выполнения GET-запросов.
- post<T>(endpoint: string, payload: object, method?: ApiPostMethod): Promise<T>: Метод для выполнения POST-запросов и других методов (PUT, DELETE, PATCH).

ApiPostMethod — Перечисление методов HTTP для запросов:
- 'POST'
- 'PUT'
- 'DELETE'
- 'PATCH'

ApiResponseList<Type> — Тип для списка данных, возвращаемых с сервера:
- total (number): Общее количество элементов.
- items (Type[]): Список элементов.

Product — Тип, описывающий товар:
- id (string): Уникальный идентификатор.
- title (string): Название товара.
- description (string): Описание.
- image (string): Ссылка на изображение.
- category (string): Категория товара.
- price (number | null): Цена товара.
- isInCart (boolean): Флаг, показывающий, добавлен ли товар в корзину.

ProductCard — Тип данных для представления карточки товара:
- id (string): Уникальный идентификатор.
- title (string): Название товара.
- description (string): Описание.
- image (string): Ссылка на изображение.
- category (string): Категория товара.
- price (number | null): Цена товара.
- isInCart (boolean): Флаг, показывающий, добавлен ли товар в корзину.
- index (number): Порядковый номер карточки.

ProductCardActions — Тип для описания действий на карточке товара:
- onClick(event: MouseEvent): void: Функция-обработчик клика.

OrderForm — Тип данных для формы заказа:
- payment (string): Способ оплаты.
- address (string): Адрес доставки.
- email (string): Электронная почта.
- phone (string): Телефон.

Order — Тип данных для заказа (расширяет OrderForm):
- total (number): Общая стоимость заказа.
- items (string[]): Список идентификаторов товаров.

OrderSuccess — Тип данных для успешного результата заказа:
- orderId (string): Идентификатор заказа.
- total (number): Итоговая сумма заказа.

OrderError — Тип данных для ошибок при оформлении заказа:
- error (string): Сообщение об ошибке.

OrderResult — Тип данных для результата заказа:
- id (string): Уникальный идентификатор заказа.
- total (number): Итоговая стоимость заказа.

AppState — Тип данных для глобального состояния приложения:
- catalog (Product[]): Список товаров.
- basket (string[]): Список идентификаторов товаров в корзине.
- preview (string | null): Идентификатор товара для предпросмотра.

FormValidationErrors — Тип для ошибок валидации формы.
- Partial<Record<keyof OrderForm, string>>: Ассоциативный массив, где ключами являются поля формы, а значениями — сообщения об ошибках.

ModalContent — Тип данных для содержимого модального окна:
- content (HTMLElement): DOM-элемент, отображаемый в модальном окне.

PageState — Тип данных для состояния страницы:
- counter (number): Счётчик взаимодействий или событий.
- catalog (HTMLElement[]): DOM-элементы каталога товаров.
- isLocked (boolean): Флаг блокировки страницы (например, во время загрузки данных).

LarekAPI — Тип для методов взаимодействия с API.
- fetchProductList(): Promise<Product[]>: Получение списка товаров.
- fetchProductById(productId: string): Promise<Product>: Получение данных о конкретном товаре по идентификатору.
- submitOrder(order: Order): Promise<OrderResult>: Отправка данных заказа.

FormState — Тип для состояния формы:
- valid (boolean): Флаг, указывающий на успешную валидацию формы.
- errors (string[]): Список сообщений об ошибках.

Product — Тип данных, описывающий товар.
- id (string): Уникальный идентификатор товара.
- name (string): Название товара.
- description (string): Описание товара.
- price (number): Цена товара.
- available (boolean): Флаг, показывающий наличие товара на складе (доступен или нет).

CartItem — Тип данных, описывающий элемент в корзине.
- product (Product): Объект товара, добавленного в корзину.
- quantity (number): Количество единиц товара в корзине.
- totalPrice (number): Общая стоимость позиции (рассчитывается как product.price * quantity).

Cart — Тип данных для представления корзины пользователя.
- items (CartItem[]): Список товаров, добавленных в корзину.
- totalQuantity (number): Общее количество товаров в корзине.
- totalPrice (number): Общая стоимость всех товаров в корзине.

Order — Тип данных для представления заказа.
- id (string): Уникальный идентификатор заказа.
- items (CartItem[]): Список товаров, включённых в заказ.
- address (string): Адрес доставки.
- paymentMethod (string): Способ оплаты (например, «кредитная карта», «наличными»).
- status (string): Статус заказа (например, «в обработке», «оплачен», «доставлен»).
- totalPrice (number): Общая стоимость заказа.

User — Тип данных, представляющий пользователя.
- id (string): Уникальный идентификатор пользователя.
- email (string): Электронная почта пользователя.
- phone (string): Телефон пользователя.
- address (string): Адрес доставки по умолчанию.

OrderConfirmation — Тип данных, представляющий подтверждение заказа.
- orderId (string): Идентификатор подтвержденного заказа.
- message (string): Сообщение подтверждения (например, «Ваш заказ успешно оплачен»).
- status (string): Статус подтверждения заказа.

Error — Тип данных для ошибок валидации или других ошибок, отображаемых пользователю.
- code (number): Код ошибки (например, 400 для ошибки валидации).
- message (string): Сообщение ошибки для отображения пользователю.

Modal — Тип данных, представляющий модальное окно.
- isOpen (boolean): Флаг, указывающий на то, открыто ли модальное окно.
- content (string | null): Контент модального окна (например, информация о товаре или сообщение подтверждения).
- onClose (function): Функция для закрытия модального окна.

PaymentMethod — Перечисление, представляющее способы оплаты.
- CASH: Оплата наличными.
- CARD: Оплата картой.
- ONLINE: Онлайн-оплата.

## Список событий

- modal:open - открыто модальное окно
- preview:changed - изменился товар для предпросмотра
- items:changed - изменение массива товаров
- card:selected - товар выбран для отображения в модальном окне
- item:addToCart - товар добавлен в корзину
- basket:delete - товар удален из корзины
- basket:changed - корзина обновлена
- basket:open - корзина открыта
- order:start - открытие формы заказа 1й шаг
- order:submit - открытие формы заказа 2й шаг
- contacts:submit - заказ отравлен

## Взаимодействие компонентов

- View генерирует события через EventEmitter.
- Presenter обрабатывает события и обновляет Model.
- Обновлённые данные из Model отправляются обратно в View, где отображаются изменения.